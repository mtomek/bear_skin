{#
  Master field template.

  This template allows themers to:
    - choose which HTML element to use,
    - add classes,
    - set other attributes
  for:
    - the field wrapper,
    - the field label,
    - the field items element,
    - the field item element.
#}

{# Define classes that should be applied to all field wrappers. #}
{%
  set global_wrapper_classes = [
    'field',
    'field--name-' ~ field_name|clean_class,
    'field--type-' ~ field_type|clean_class,
    'field--label-' ~ label_display
  ]
%}

{# Define classes that should be applied to all field labels. #}
{%
  set global_label_classes = [
    'field__label',
    label_display == 'visually_hidden' ? 'visually-hidden',
  ]
%}

{# Handle Items Attributes #}
{% set default_items_attributes = create_attribute({
  'class': items_classes ?: 'field__items'
}) %}
{% if items_attributes %}
  {% for key, value in items_attributes %}
    {% set default_items_attributes = default_items_attributes.setAttribute(key, value) %}
  {% endfor %}
{% endif %}

{# Handle Item Attributes #}
{% if item_attributes %}
  {% for item in items %}
    {% for key, value in item_attributes %}
      {% set item = item.attributes.setAttribute(key, value) %}
    {% endfor %}
  {% endfor %}
{% endif %}

<{{ wrapper_element ?: 'div' }}{{ attributes.addClass(global_wrapper_classes, wrapper_classes ?: wrapper_classes).removeClass('field') }}>

  {% block label %}
  {% if not label_hidden %}
    <{{ label_element ?: 'h3' }}{{ title_attributes.addClass(global_label_classes, label_classes ?: label_classes) }}>
      {{ label }}
    </{{ label_element ?: 'h3' }}>
  {% endif %}
  {% endblock %}

  {% block content %}
  {% if multiple %}
    <{{ items_element ?: 'div'}}{{ default_items_attributes }}>
  {% endif %}

  {% for item in items %}
    <{{ item_element ?: 'div'}}{{ item.attributes.addClass(item_classes ?: 'field__item') }}>
      {{ item.content }}
    </{{ item_element ?: 'div'}}>
  {% endfor %}

  {% if multiple %}
    </{{ items_element ?: 'div'}}>
  {% endif %}
  {% endblock %}

</{{ wrapper_element ?: 'div' }}>
